# Распознавание пород собак
Данный проект разрабатывается для определения породы собаки по фотографии. В дальнейшем такая система может быть интегрирована в мобильное приложение или веб-клиент. Основная задача, которая решается: детекция собаки + классификация породы.

Примеры изображений:

<img src="images/boxer.jpg" alt="Боксёр" height="250">
<img src="images/dolmatinec.jpg" alt="Долматинец" height="250">
<img src="images/haski.jpg" alt="Хаски" height="250">


## Источники данных
За основу взяты открытые датасеты:
- [Stanford Dogs Dataset](https://www.kaggle.com/datasets/jessicali9530/stanford-dogs-dataset/data).
- [computer-science-gtrnn/dog-breeds](https://universe.roboflow.com/computer-science-gtrnn/dog-breeds-u4eaf)

Чтобы их можно было использовать в дальнейшем обучении все датасеты приведены в формат COCO.

Для обогащения данных используются следующие сайты:
- [dogsindepth.com](https://dogsindepth.com/list_of_all_dog_breeds.html)
- [Dogtime.com](https://dogtime.com/dog-breeds)

Для скраппинга данных были созданы скрипты, они находятся в [`scripts`](scripts/).


## EDA
- Всего изображений в датасете: 30529
- В датасете есть небольшой дисбаланс классов, а особо проблемным является класс **Basset Fauve De Bretagne, он имеет 24 объекта**.
- В данный момент, без учёта дополнительно собранных данных есть **161 класс**.

![Распределение классов](images/class_distribution.png)


## Где могут использоваться эти данные?
- Детекция собак
- Классификация пород


## Процесс очистки данных
Процесс очистки данных находится в ноутбуке [`DataCleaning`](notebooks/DataCleaning.ipynb), в рамках данного процесса были достигнуты результаты:
- Были объединены метки из двух датасетов, чтобы они не дублировали друг-друга
- Были найдены данные без меток (их оказалось 3 штуки и они были удалены)
- Были найдены дублирующиеся изображения (они появились при слиянии датасетов, дубликаты были удалены)


## Процесс разметки данных
- Собранные из интернета данные были разбиты на 3 части ([скрипт](labeling/scripts/split_dataset_in_parts.py))
    - 1203 (по 441 на человека (из них 10% перекрытия))
- Далее данные были обогащены honeypot примерами ([скрипт](labeling/scripts/add_honeypot_samples.py))
    - 110 на человека
- Подготовленные данные были отправлены в CVAT для разметки
    - По 551 на человека
    - 19% honeypot
    - 10% перекрытия между разметчиками (для оценки согласованности)
- Разметчикам была выдана инструкция ([инструкция](labeling/task_description.md))
- После разметки данные были собраны ([скрипт](labeling/scripts/download_cvat_task.py))
- Проведён анализ полученной разметки ([ноутбук](notebooks/checking_labels.ipynb))

#### Итеративное обновление инструкции
- Версия 1.0

    Базовая версия, которая содержала описание задачи и основные пункты по тому как пользоваться CVAT
- Версия 1.1

    Разметчики сказали, что было проблематично разбираться с инструкцией, поэтому были добавлены изображения к основным пунктам документа
- Версия 1.2

    В инструкцию были добавлены пункты о том когда следует удалять объекты, тк разметчики пропускали много двойных собак и пустых изображений
